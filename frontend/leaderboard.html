<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LEADERBOARD // GLOBAL_RANK</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="leaderboard-page"> 
    <h1 style="padding-top: 20px;">LEADERBOARD</h1>
    
    <!-- <div class="decor-lines" style="width: 1000px; margin-top: 10px;"> <div class="line-long"></div>
        <div class="scan-text">FETCHING_GLOBAL_OPERATOR_DATA... [SYNC_COMPLETE]</div>
        <div class="line-long" style="width: 70%; opacity: 0.5;"></div>
    </div> -->

    <div class="lb-container"> <table class="lb-table">
            <thead>
                <tr>
                    <th>RANK</th>
                    <th>PLAYER</th>
                    <th>POINTS</th>
                    <th>SYNC_TIME</th>
                </tr>
            </thead>
            <tbody id="lb-data">
                </tbody>
        </table>

        <a href="dashboard.html" style="display:block; margin-top:50px; color:var(--neon-orange); text-decoration:none; font-size:0.9rem; letter-spacing:4px; opacity: 0.7; font-family: 'Syncopate', sans-serif;">
            < BACK_TO_TERMINAL >
        </a>
    </div>

    <script>
        async function load() {
            try {
                const res = await fetch('/api/leaderboard');
                const data = await res.json();
                const tbody = document.getElementById('lb-data');
                
                tbody.innerHTML = data.map((e, i) => `
                    <tr>
                        <td style="font-weight: bold; color: ${i < 3 ? 'var(--neon-orange)' : '#fff'};">
                            #0${i + 1}
                        </td>
                        <td style="letter-spacing: 2px;">${e.user.username.toUpperCase()}</td>
                        <td style="font-family: 'Syncopate', sans-serif;">${e.totalScore}</td>
                        <td style="font-size: 0.9rem; color: #666;">${new Date(e.lastSub).toLocaleTimeString()}</td>
                    </tr>
                `).join('');
            } catch (err) {
                console.error("Failed to load rankings");
            }
        }
        load();
        setInterval(load, 15000); // Refresh every 15 seconds
    </script>
</body>
</html>